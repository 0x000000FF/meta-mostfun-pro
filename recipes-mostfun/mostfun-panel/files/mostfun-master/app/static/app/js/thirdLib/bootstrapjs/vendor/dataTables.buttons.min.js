/*!
 Buttons for DataTables 1.2.1
 Êºè2016 SpryMedia Ltd - datatables.net/license
 */

(function(e){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(t){return e(t,window,document)}):"object"==typeof exports?module.exports=function(t,n){t||(t=window);if(!n||!n.fn.dataTable)n=require("datatables.net")(t,n).$;return e(n,t,t.document)}:e(jQuery,window,document)})(function(e,t,n,r){var i=e.fn.dataTable,s=0,o=0,u=i.ext.buttons,a=function(t,n){!0===n&&(n={}),e.isArray(n)&&(n={buttons:n}),this.c=e.extend(!0,{},a.defaults,n),n.buttons&&(this.c.buttons=n.buttons),this.s={dt:new i.Api(t),buttons:[],listenKeys:"",namespace:"dtb"+s++},this.dom={container:e("<"+this.c.dom.container.tag+"/>").addClass(this.c.dom.container.className)},this._constructor()};e.extend(a.prototype,{action:function(e,t){var n=this._nodeToButton(e);return t===r?n.conf.action:(n.conf.action=t,this)},active:function(t,n){var i=this._nodeToButton(t),s=this.c.dom.button.active,i=e(i.node);return n===r?i.hasClass(s):(i.toggleClass(s,n===r?!0:n),this)},add:function(e,t){var n=this.s.buttons;if("string"==typeof t){for(var r=t.split("-"),n=this.s,i=0,s=r.length-1;i<s;i++)n=n.buttons[1*r[i]];n=n.buttons,t=1*r[r.length-1]}return this._expandButton(n,e,!1,t),this._draw(),this},container:function(){return this.dom.container},disable:function(t){return t=this._nodeToButton(t),e(t.node).addClass(this.c.dom.button.disabled),this},destroy:function(){e("body").off("keyup."+this.s.namespace);var t=this.s.buttons.slice(),n,r;n=0;for(r=t.length;n<r;n++)this.remove(t[n].node);this.dom.container.remove(),t=this.s.dt.settings()[0],n=0;for(r=t.length;n<r;n++)if(t.inst===this){t.splice(n,1);break}return this},enable:function(t,n){if(!1===n)return this.disable(t);var r=this._nodeToButton(t);return e(r.node).removeClass(this.c.dom.button.disabled),this},name:function(){return this.c.name},node:function(t){return t=this._nodeToButton(t),e(t.node)},remove:function(t){var n=this._nodeToButton(t),r=this._nodeToHost(t),i=this.s.dt;if(n.buttons.length)for(var s=n.buttons.length-1;0<=s;s--)this.remove(n.buttons[s].node);return n.conf.destroy&&n.conf.destroy.call(i.button(t),i,e(t),n.conf),this._removeKey(n.conf),e(n.node).remove(),t=e.inArray(n,r),r.splice(t,1),this},text:function(t,n){var i=this._nodeToButton(t),s=this.c.dom.collection.buttonLiner,s=i.inCollection&&s&&s.tag?s.tag:this.c.dom.buttonLiner.tag,o=this.s.dt,u=e(i.node),a=function(e){return"function"==typeof e?e(o,u,i.conf):e};return n===r?a(i.conf.text):(i.conf.text=n,s?u.children(s).html(a(n)):u.html(a(n)),this)},_constructor:function(){var t=this,r=this.s.dt,i=r.settings()[0],s=this.c.buttons;i._buttons||(i._buttons=[]),i._buttons.push({inst:this,name:this.c.name});for(var i=0,o=s.length;i<o;i++)this.add(s[i]);r.on("destroy",function(){t.destroy()}),e("body").on("keyup."+this.s.namespace,function(e){if(!n.activeElement||n.activeElement===n.body){var r=String.fromCharCode(e.keyCode).toLowerCase();t.s.listenKeys.toLowerCase().indexOf(r)!==-1&&t._keypress(r,e)}})},_addKey:function(t){t.key&&(this.s.listenKeys+=e.isPlainObject(t.key)?t.key.key:t.key)},_draw:function(e,t){e||(e=this.dom.container,t=this.s.buttons),e.children().detach();for(var n=0,r=t.length;n<r;n++)e.append(t[n].inserter),t[n].buttons&&t[n].buttons.length&&this._draw(t[n].collection,t[n].buttons)},_expandButton:function(t,n,i,s){for(var o=this.s.dt,u=0,n=e.isArray(n)?n:[n],a=0,f=n.length;a<f;a++){var l=this._resolveExtends(n[a]);if(l)if(e.isArray(l))this._expandButton(t,l,i,s);else{var c=this._buildButton(l,i);if(c){s!==r?(t.splice(s,0,c),s++):t.push(c);if(c.conf.buttons){var h=this.c.dom.collection;c.collection=e("<"+h.tag+"/>").addClass(h.className),c.conf._collection=c.collection,this._expandButton(c.buttons,c.conf.buttons,!0,s)}l.init&&l.init.call(o.button(c.node),o,e(c.node),l),u++}}}},_buildButton:function(t,n){var r=this.c.dom.button,i=this.c.dom.buttonLiner,s=this.c.dom.collection,u=this.s.dt,a=function(e){return"function"==typeof e?e(u,l,t):e};n&&s.button&&(r=s.button),n&&s.buttonLiner&&(i=s.buttonLiner);if(t.available&&!t.available(u,t))return!1;var f=function(t,n,r,i){i.action.call(n.button(r),t,n,r,i),e(n.table().node()).triggerHandler("buttons-action.dt",[n.button(r),n,r,i])},l=e("<"+r.tag+"/>").addClass(r.className).attr("tabindex",this.s.dt.settings()[0].iTabIndex).attr("aria-controls",this.s.dt.table().node().id).on("click.dtb",function(e){e.preventDefault(),!l.hasClass(r.disabled)&&t.action&&f(e,u,l,t),l.blur()}).on("keyup.dtb",function(e){e.keyCode===13&&!l.hasClass(r.disabled)&&t.action&&f(e,u,l,t)});return"a"===r.tag.toLowerCase()&&l.attr("href","#"),i.tag?(s=e("<"+i.tag+"/>").html(a(t.text)).addClass(i.className),"a"===i.tag.toLowerCase()&&s.attr("href","#"),l.append(s)):l.html(a(t.text)),!1===t.enabled&&l.addClass(r.disabled),t.className&&l.addClass(t.className),t.titleAttr&&l.attr("title",t.titleAttr),t.namespace||(t.namespace=".dt-button-"+o++),i=(i=this.c.dom.buttonContainer)&&i.tag?e("<"+i.tag+"/>").addClass(i.className).append(l):l,this._addKey(t),{conf:t,node:l.get(0),inserter:i,buttons:[],inCollection:n,collection:null}},_nodeToButton:function(e,t){t||(t=this.s.buttons);for(var n=0,r=t.length;n<r;n++){if(t[n].node===e)return t[n];if(t[n].buttons.length){var i=this._nodeToButton(e,t[n].buttons);if(i)return i}}},_nodeToHost:function(e,t){t||(t=this.s.buttons);for(var n=0,r=t.length;n<r;n++){if(t[n].node===e)return t;if(t[n].buttons.length){var i=this._nodeToHost(e,t[n].buttons);if(i)return i}}},_keypress:function(t,n){var r=function(i){for(var s=0,o=i.length;s<o;s++){var u=i[s].conf,a=i[s].node;u.key&&(u.key===t?e(a).click():e.isPlainObject(u.key)&&u.key.key===t&&(!u.key.shiftKey||n.shiftKey)&&(!u.key.altKey||n.altKey)&&(!u.key.ctrlKey||n.ctrlKey)&&(!u.key.metaKey||n.metaKey)&&e(a).click()),i[s].buttons.length&&r(i[s].buttons)}};r(this.s.buttons)},_removeKey:function(t){if(t.key){var n=e.isPlainObject(t.key)?t.key.key:t.key,t=this.s.listenKeys.split(""),n=e.inArray(n,t);t.splice(n,1),this.s.listenKeys=t.join("")}},_resolveExtends:function(t){for(var n=this.s.dt,i,s,o=function(i){for(var s=0;!e.isPlainObject(i)&&!e.isArray(i);){if(i===r)return;if("function"==typeof i){if(i=i(n,t),!i)return!1}else if("string"==typeof i){if(!u[i])throw"Unknown button type: "+i;i=u[i]}s++;if(30<s)throw"Buttons: Too many iterations"}return e.isArray(i)?i:e.extend({},i)},t=o(t);t&&t.extend;){if(!u[t.extend])throw"Cannot extend unknown button type: "+t.extend;var a=o(u[t.extend]);if(e.isArray(a))return a;if(!a)return!1;i=a.className,t=e.extend({},a,t),i&&t.className!==i&&(t.className=i+" "+t.className);var f=t.postfixButtons;if(f){t.buttons||(t.buttons=[]),i=0;for(s=f.length;i<s;i++)t.buttons.push(f[i]);t.postfixButtons=null}if(f=t.prefixButtons){t.buttons||(t.buttons=[]),i=0;for(s=f.length;i<s;i++)t.buttons.splice(i,0,f[i]);t.prefixButtons=null}t.extend=a.extend}return t}}),a.background=function(t,n,i){i===r&&(i=400),t?e("<div/>").addClass(n).css("display","none").appendTo("body").fadeIn(i):e("body > div."+n).fadeOut(i,function(){e(this).remove()})},a.instanceSelector=function(t,n){if(!t)return e.map(n,function(e){return e.inst});var r=[],i=e.map(n,function(e){return e.name}),s=function(t){if(e.isArray(t))for(var o=0,u=t.length;o<u;o++)s(t[o]);else"string"==typeof t?-1!==t.indexOf(",")?s(t.split(",")):(t=e.inArray(e.trim(t),i),-1!==t&&r.push(n[t].inst)):"number"==typeof t&&r.push(n[t].inst)};return s(t),r},a.buttonSelector=function(t,n){for(var i=[],s=function(e,t,n){for(var i,o,u=0,a=t.length;u<a;u++)if(i=t[u])o=n!==r?n+u:u+"",e.push({node:i.node,name:i.conf.name,idx:o}),i.buttons&&s(e,i.buttons,o+"-")},o=function(t,n){var u,a,f=[];s(f,n.s.buttons),u=e.map(f,function(e){return e.node});if(e.isArray(t)||t instanceof e){u=0;for(a=t.length;u<a;u++)o(t[u],n)}else if(null===t||t===r||"*"===t){u=0;for(a=f.length;u<a;u++)i.push({inst:n,node:f[u].node})}else if("number"==typeof t)i.push({inst:n,node:n.s.buttons[t].node});else if("string"==typeof t)if(-1!==t.indexOf(",")){f=t.split(","),u=0;for(a=f.length;u<a;u++)o(e.trim(f[u]),n)}else if(t.match(/^\d+(\-\d+)*$/))u=e.map(f,function(e){return e.idx}),i.push({inst:n,node:f[e.inArray(t,u)].node});else if(-1!==t.indexOf(":name")){var l=t.replace(":name","");u=0;for(a=f.length;u<a;u++)f[u].name===l&&i.push({inst:n,node:f[u].node})}else e(u).filter(t).each(function(){i.push({inst:n,node:this})});else"object"==typeof t&&t.nodeName&&(f=e.inArray(t,u),-1!==f&&i.push({inst:n,node:u[f]}))},u=0,a=t.length;u<a;u++)o(n,t[u]);return i},a.defaults={buttons:["copy","excel","csv","pdf","print"],name:"main",tabIndex:0,dom:{container:{tag:"div",className:"dt-buttons"},collection:{tag:"div",className:"dt-button-collection"},button:{tag:"a",className:"dt-button",active:"active",disabled:"disabled"},buttonLiner:{tag:"span",className:""}}},a.version="1.2.1",e.extend(u,{collection:{text:function(e){return e.i18n("buttons.collection","Collection")},className:"buttons-collection",action:function(n,r,i,s){var n=i.offset(),o=e(r.table().container()),u=!1;e("div.dt-button-background").length&&(u=e("div.dt-button-collection").offset(),e("body").trigger("click.dtb-collection")),s._collection.addClass(s.collectionLayout).css("display","none").appendTo("body").fadeIn(s.fade);var f=s._collection.css("position");u&&"absolute"===f?s._collection.css({top:u.top+5,left:u.left+5}):"absolute"===f?(s._collection.css({top:n.top+i.outerHeight(),left:n.left}),i=n.left+s._collection.outerWidth(),o=o.offset().left+o.width(),i>o&&s._collection.css("left",n.left-(i-o))):(n=s._collection.height()/2,n>e(t).height()/2&&(n=e(t).height()/2),s._collection.css("marginTop",-1*n)),s.background&&a.background(!0,s.backgroundClassName,s.fade),setTimeout(function(){e("div.dt-button-background").on("click.dtb-collection",function(){}),e("body").on("click.dtb-collection",function(t){e(t.target).parents().andSelf().filter(s._collection).length||(s._collection.fadeOut(s.fade,function(){s._collection.detach()}),e("div.dt-button-background").off("click.dtb-collection"),a.background(!1,s.backgroundClassName,s.fade),e("body").off("click.dtb-collection"),r.off("buttons-action.b-internal"))})},10),s.autoClose&&r.on("buttons-action.b-internal",function(){e("div.dt-button-background").click()})},background:!0,collectionLayout:"",backgroundClassName:"dt-button-background",autoClose:!1,fade:400},copy:function(e,t){if(u.copyHtml5)return"copyHtml5";if(u.copyFlash&&u.copyFlash.available(e,t))return"copyFlash"},csv:function(e,t){if(u.csvHtml5&&u.csvHtml5.available(e,t))return"csvHtml5";if(u.csvFlash&&u.csvFlash.available(e,t))return"csvFlash"},excel:function(e,t){if(u.excelHtml5&&u.excelHtml5.available(e,t))return"excelHtml5";if(u.excelFlash&&u.excelFlash.available(e,t))return"excelFlash"},pdf:function(e,t){if(u.pdfHtml5&&u.pdfHtml5.available(e,t))return"pdfHtml5";if(u.pdfFlash&&u.pdfFlash.available(e,t))return"pdfFlash"},pageLength:function(t){var t=t.settings()[0].aLengthMenu,n=e.isArray(t[0])?t[0]:t,r=e.isArray(t[0])?t[1]:t,i=function(e){return e.i18n("buttons.pageLength",{"-1":"Show all rows",_:"Show %d rows"},e.page.len())};return{extend:"collection",text:i,className:"buttons-page-length",autoClose:!0,buttons:e.map(n,function(e,t){return{text:r[t],action:function(t,n){n.page.len(e).draw()},init:function(t,n,r){var i=this,n=function(){i.active(t.page.len()===e)};t.on("length.dt"+r.namespace,n),n()},destroy:function(e,t,n){e.off("length.dt"+n.namespace)}}}),init:function(e,t,n){var r=this;e.on("length.dt"+n.namespace,function(){r.text(i(e))})},destroy:function(e,t,n){e.off("length.dt"+n.namespace)}}}}),i.Api.register("buttons()",function(e,t){return t===r&&(t=e,e=r),this.iterator(!0,"table",function(n){if(n._buttons)return a.buttonSelector(a.instanceSelector(e,n._buttons),t)},!0)}),i.Api.register("button()",function(e,t){var n=this.buttons(e,t);return 1<n.length&&n.splice(1,n.length),n}),i.Api.registerPlural("buttons().active()","button().active()",function(e){return e===r?this.map(function(e){return e.inst.active(e.node)}):this.each(function(t){t.inst.active(t.node,e)})}),i.Api.registerPlural("buttons().action()","button().action()",function(e){return e===r?this.map(function(e){return e.inst.action(e.node)}):this.each(function(t){t.inst.action(t.node,e)})}),i.Api.register(["buttons().enable()","button().enable()"],function(e){return this.each(function(t){t.inst.enable(t.node,e)})}),i.Api.register(["buttons().disable()","button().disable()"],function(){return this.each(function(e){e.inst.disable(e.node)})}),i.Api.registerPlural("buttons().nodes()","button().node()",function(){var t=e();return e(this.each(function(e){t=t.add(e.inst.node(e.node))})),t}),i.Api.registerPlural("buttons().text()","button().text()",function(e){return e===r?this.map(function(e){return e.inst.text(e.node)}):this.each(function(t){t.inst.text(t.node,e)})}),i.Api.registerPlural("buttons().trigger()","button().trigger()",function(){return this.each(function(e){e.inst.node(e.node).trigger("click")})}),i.Api.registerPlural("buttons().containers()","buttons().container()",function(){var t=e();return e(this.each(function(e){t=t.add(e.inst.container())})),t}),i.Api.register("button().add()",function(e,t){return 1===this.length&&this[0].inst.add(t,e),this.button(e)}),i.Api.register("buttons().destroy()",function(){return this.pluck("inst").unique().each(function(e){e.destroy()}),this}),i.Api.registerPlural("buttons().remove()","buttons().remove()",function(){return this.each(function(e){e.inst.remove(e.node)}),this});var f;i.Api.register("buttons.info()",function(t,n,i){var s=this;return!1===t?(e("#datatables_buttons_info").fadeOut(function(){e(this).remove()}),clearTimeout(f),f=null,this):(f&&clearTimeout(f),e("#datatables_buttons_info").length&&e("#datatables_buttons_info").remove(),e('<div id="datatables_buttons_info" class="dt-button-info"/>').html(t?"<h2>"+t+"</h2>":"").append(e("<div/>")["string"==typeof n?"html":"append"](n)).css("display","none").appendTo("body").fadeIn(),i!==r&&0!==i&&(f=setTimeout(function(){s.buttons.info(!1)},i)),this)}),i.Api.register("buttons.exportData()",function(t){if(this.context.length){for(var n=new i.Api(this.context[0]),r=e.extend(!0,{},{rows:null,columns:"",modifier:{search:"applied",order:"applied"},orthogonal:"display",stripHtml:!0,stripNewlines:!0,decodeEntities:!0,trim:!0,format:{header:function(e){return s(e)},footer:function(e){return s(e)},body:function(e){return s(e)}}},t),s=function(e){return"string"!=typeof e?e:(r.stripHtml&&(e=e.replace(/<[^>]*>/g,"")),r.trim&&(e=e.replace(/^\s+|\s+$/g,"")),r.stripNewlines&&(e=e.replace(/\n/g," ")),r.decodeEntities&&(l.innerHTML=e,e=l.value),e)},t=n.columns(r.columns).indexes().map(function(e){return r.format.header(n.column(e).header().innerHTML,e)}).toArray(),o=n.table().footer()?n.columns(r.columns).indexes().map(function(e){var t=n.column(e).footer();return r.format.footer(t?t.innerHTML:"",e)}).toArray():null,u=n.rows(r.rows,r.modifier).indexes().toArray(),u=n.cells(u,r.columns).render(r.orthogonal).toArray(),a=t.length,f=0<a?u.length/a:0,c=Array(f),h=0,p=0;p<f;p++){for(var v=Array(a),m=0;m<a;m++)v[m]=r.format.body(u[h],m,p),h++;c[p]=v}return{header:t,footer:o,body:c}}});var l=e("<textarea/>")[0];return e.fn.dataTable.Buttons=a,e.fn.DataTable.Buttons=a,e(n).on("init.dt plugin-init.dt",function(e,t){if("dt"===e.namespace){var n=t.oInit.buttons||i.defaults.buttons;n&&!t._buttons&&(new a(t,n)).container()}}),i.ext.feature.push({fnInit:function(e){var e=new i.Api(e),t=e.init().buttons||i.defaults.buttons;return(new a(e,t)).container()},cFeature:"B"}),a});